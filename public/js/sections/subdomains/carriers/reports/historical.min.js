(()=>{let t=[],e=null;function a(){}a.prototype.init=t=>{this.eGui=document.createElement("div"),t.data.id&&(this.eGui.innerHTML=`<a href="/carrier/payment/downloadPDF/${t.data.id}" target="_blank"><i class="fa fa-file-pdf-o"></i> PDF</a>`)},a.prototype.getGui=()=>this.eGui;const r=$("#dateRange"),o=t=>isNaN(t.value)?t.value:numeral(t.value).format("$0,0.00"),i=(i=r.data().daterangepicker.startDate,d=r.data().daterangepicker.endDate)=>{$.ajax({url:"/report/historicalData",type:"GET",data:{},success:r=>{t=[];let i=0,d=0,n=0;r.forEach((e=>{t.push({id:e.id,date:e.date,subtotal:e.gross_amount,reductions:e.reductions,total:e.total}),i+=Number(e.gross_amount),d+=Number(e.reductions),n+=Number(e.total)})),(t=>{const a=[{name:"Subtotal",data:[t.subtotal.toFixed(2)]},{name:"Reductions",data:[t.reductions.toFixed(2)]},{name:"Total",data:[t.total.toFixed(2)]}];if(e)return void e.updateSeries(a);let r={chart:{height:350,type:"bar"},colors:[chartColorsObj.success,chartColorsObj.danger,chartColorsObj.primary],plotOptions:{bar:{horizontal:!1,endingShape:"flat",columnWidth:"55%"}},dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},series:a,legend:{offsetY:-10},xaxis:{categories:[""]},yaxis:{title:{text:"$ (summary)"}},fill:{opacity:1},tooltip:{y:{formatter:function(t){return numeral(t).format("$0,0.00")}}}};e=new ApexCharts(document.querySelector("#chart"),r),e.render()})({subtotal:i,reductions:d,total:n}),(()=>{if(_aggrid)return _aggrid.rowData=t,_aggrid.gridOptions.api.setRowData(t),_aggrid.grid.gridOptions.api.setPinnedBottomRowData(_aggrid.pinnedBottomFunction(_aggrid)),void _aggrid.gridOptions.api.sizeColumnsToFit();_aggrid=new simpleTableAG({id:"reportTable",columns:[{headerName:"Date",field:"date"},{headerName:"Subtotal",field:"subtotal",valueFormatter:o},{headerName:"Reductions",field:"reductions",valueFormatter:o},{headerName:"Total",field:"total",valueFormatter:o},{headerName:"",field:"menu",cellRenderer:a}],gridOptions:{components:{tableRef:"_aggrid",MenuRenderer:a}},pinnedBottomFunction:t=>{let e=0,a=0,r=0;return t.rowData.forEach((t=>{e+=Number(t.subtotal),a+=Number(t.reductions),r+=Number(t.total)})),[{date:"",subtotal:e,reductions:a,total:r}]},autoHeight:!0,rowData:t}),setTimeout((()=>{_aggrid.gridOptions.api.sizeColumnsToFit()}),300)})()}})};r.daterangepicker({format:"YYYY/MM/DD",startDate:moment().startOf("month"),endDate:moment().endOf("month")},((t,e,a)=>{i(t,e)})),i()})();
