(()=>{const a=$("#morningTable"),t=$("#nightTable"),e="#driverStatusModal",r=$(e),d=$("#shipper"),i=()=>{$.ajax({url:"/driver/search",data:{dispatch:!0,count:!0,shipper:d.val()},success:r=>{const d=a.find("tbody");d.empty(),d.append(`<tr><td><a class="d-block" id="morning_active" href="${e}" data-toggle="modal" data-target="${e}">${r.morning.active}</a></td><td><a class="d-block" id="morning_inactive" href="${e}" data-toggle="modal" data-target="${e}">${r.morning.inactive}</a></td><td><a class="d-block" id="morning_awaiting" href="${e}" data-toggle="modal" data-target="${e}">${r.morning.awaiting}</a></td><td><a class="d-block" id="morning_loaded" href="${e}" data-toggle="modal" data-target="${e}">${r.morning.loaded}</a></td></tr>`),$("#morning_dispatch").html(`Morning - ${r.morning.active+r.morning.inactive}`);const i=t.find("tbody");i.empty(),i.append(`<tr><td><a class="d-block" id="night_active" href="${e}" data-toggle="modal" data-target="${e}">${r.night.active}</a></td><td><a class="d-block" id="night_inactive" href="${e}" data-toggle="modal" data-target="${e}">${r.night.inactive}</a></td><td><a class="d-block" id="night_awaiting" href="${e}" data-toggle="modal" data-target="${e}">${r.night.awaiting}</a></td><td><a class="d-block" id="night_loaded" href="${e}" data-toggle="modal" data-target="${e}">${r.night.loaded}</a></td></tr>`),$("#night_dispatch").html(`Night - ${r.night.active+r.night.inactive}`)},error:()=>{throwErrorMsg()}})};i();let n=null,l=null;const o=a=>a.value?a.value.name:"",c=a=>a.data&&a.data.carrier.phone?a.data.carrier.phone:"",g=a=>a.data&&a.data.truck&&a.data.truck.trailer?a.data.truck.trailer.number:"",s=a=>a.value?a.value.number:"";r.on("show.modal.bs",(a=>{const t=$(a.relatedTarget).attr("id");n=t.split("_"),l?l.searchQueryParams.type!==n&&(l.searchQueryParams.type=n,l.searchQueryParams.shipper=d.val(),l.updateSearchQuery()):l=new tableAG({container:"driverStatusTable",columns:[{headerName:"Truck #",field:"truck",valueFormatter:s},{headerName:"Chassis NÂº",field:"trailer",valueFormatter:g},{headerName:"Driver",field:"name"},{headerName:"Phone",field:"phone"},{headerName:"Carrier",field:"carrier",valueFormatter:o},{headerName:"Carrier phone",field:"carrier_phone",valueFormatter:c}],gridOptions:{components:{tableRef:"tbDriverStatus"}},url:"/driver/search",searchQueryParams:{dispatch:!0,type:n,shipper:d.val()}})})),d.change((()=>{i()}))})();
