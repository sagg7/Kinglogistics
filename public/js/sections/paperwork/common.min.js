(()=>{const e=$("#advancedTemplate"),t=e.find(":input"),a=$("#simpleTemplate"),l=a.find(":input"),i=$("#mode"),s=$("#type"),d=$("#shipper_id"),n=i=>{switch(i){case"0":l.prop("disabled",!1),t.prop("disabled",!0),a.removeClass("d-none"),e.addClass("d-none");break;case"1":l.prop("disabled",!0),t.prop("disabled",!1),a.addClass("d-none"),e.removeClass("d-none")}},r=()=>{switch(s.val()){case"driver":d.prop("disabled",!1);break;default:d.prop("disabled",!0)}};i.select2({placeholder:"Select"}).on("select2:select",(e=>{n(e.params.data.id)})),s.select2({placeholder:"Select"}).on("select2:select",(e=>{r()})),l.change((e=>{const t=e.currentTarget,a=t.files,l=$(t).prev();a.length>0?l.text(a[0].name):l.text("Upload file")})),d.select2({ajax:{url:"/shipper/selection",data:e=>({search:e.term,page:e.page||1,take:15})},placeholder:"Select",allowClear:!0}),n(i.val()),r();const c=$("#imagesInput"),o=$("#imagesList"),p=e=>{const t=document.querySelector(`#${e}`);t.addEventListener("click",(()=>{window.getSelection().selectAllChildren(t),document.execCommand("copy")}))};o.find("li").each(((e,t)=>{p(t.firstElementChild.getAttribute("id"))})),c.change((e=>{let t=0;const a=o.find("code:not(.new_img)").parent();if(a.length>0){const e=a[a.length-1].firstElementChild.getAttribute("id");t=e.split("_")[1]}o.find(".new_img").parent().remove();const l=e.currentTarget.files;Array.from(l).forEach(((e,a)=>{t++;const l=`img_${t}`;o.append(`<li><code id="${l}" class="new_img">{{"image":"${t}"}}</code></li>`),p(l)}))})),$(".deleteImage").click((e=>{const t=$(e.currentTarget),a=t.closest("li"),l=t.data("imageid");confirmMsg({config:{title:"Confirm deleting the image file?"},onConfirm:()=>{$.ajax({url:"/paperwork/deleteImage",type:"POST",data:{id:l},success:e=>{e.success&&a.remove()},error:()=>{throwErrorMsg()}})}})}))})();
