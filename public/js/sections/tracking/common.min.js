(()=>{const o=o=>{const e={lat:Number(o.coords.latitude),lng:Number(o.coords.longitude)},t=`<p><strong>Shipper:</strong> ${o.shippers.name}</p><p><strong>Status:</strong> ${o.load.status}<br><strong>Origin:</strong> ${o.load.origin}<br><strong>Destination:</strong> ${o.load.destination}</p><p><strong>Carrier:</strong> ${o.carrier.name}<br><strong>Driver:</strong> ${o.driver.name}<br><strong>Truck#:</strong> ${o.truck.number}</p>`,i=new google.maps.InfoWindow({content:t});let a={position:e,map:n,animation:google.maps.Animation.DROP,icon:{url:"/images/app/tracking/icons/delivery-truck.svg",scaledSize:new google.maps.Size(50,50),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)}};const s=new google.maps.Marker(a);return s.addListener("click",(()=>{i.open({anchor:s,map:n,shouldFocus:!1})})),r.push({load:{id:o.load.id},driver:{id:o.driver.id},marker:s}),s},n=new google.maps.Map(document.getElementById("map"),{center:{lat:39.8097343,lng:-98.5556199},zoom:10,disableDefaultUI:!0,zoomControl:!0,fullscreenControl:!0}),e=new google.maps.LatLngBounds;let r=[];data.forEach((n=>{const r=n.latest_location,t=r.parent_load,i=t.shipper,a=t.truck,s=n.carrier,d={driver:{id:n.id,name:n.name},truck:{number:a.number},carrier:{id:s.id,name:s.name},shippers:{id:i.id,name:i.name},coords:{latitude:Number(r.latitude),longitude:Number(r.longitude)},load:{origin:t.origin,destination:t.destination}},g=o(d);e.extend(g.position)})),n.fitBounds(e),window.Echo.private(channel).listen(echoEvent,(e=>{let t=r.find((o=>o.driver.id===e.driver.id));t?(t.marker.setPosition({lat:Number(e.coords.latitude),lng:Number(e.coords.longitude)}),t.marker.setAnimation(google.maps.Animation.BOUNCE),setTimeout((()=>{t.marker.setAnimation(null)}),600)):o(e);const i=new google.maps.LatLngBounds;r.forEach((o=>{const n=o.marker;i.extend(n.position)})),n.fitBounds(i)}))})();
