(()=>{const o=o=>{const n={lat:Number(o.coords.latitude),lng:Number(o.coords.longitude)},i=`<p><strong>Shipper:</strong> ${o.shippers.name}</p><p><strong>Origin:</strong> ${o.load.origin}<br><strong>Destination:</strong> ${o.load.destination}</p><p><strong>Carrier:</strong> ${o.carrier.name}<br><strong>Driver:</strong> ${o.driver.name}<br><strong>Truck#:</strong> ${o.truck.number}</p>`,t=new google.maps.InfoWindow({content:i});let a={position:n,map:e,animation:google.maps.Animation.DROP,icon:{url:"/images/app/tracking/icons/delivery-truck.svg",scaledSize:new google.maps.Size(50,50),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)}};const s=new google.maps.Marker(a);return s.addListener("click",(()=>{t.open({anchor:s,map:e,shouldFocus:!1})})),r.push({load:{id:o.load.id},driver:{id:o.driver.id},marker:s}),s},e=new google.maps.Map(document.getElementById("map"),{center:{lat:39.8097343,lng:-98.5556199},zoom:10,disableDefaultUI:!0,zoomControl:!0,fullscreenControl:!0}),n=new google.maps.LatLngBounds;let r=[];data.forEach((e=>{const r=e.latest_location,i=r.parent_load,t=i.shipper,a=i.truck,s=e.carrier,d={driver:{id:e.id,name:e.name},truck:{number:a.number},carrier:{id:s.id,name:s.name},shippers:{id:t.id,name:t.name},coords:{latitude:Number(r.latitude),longitude:Number(r.longitude)},load:{origin:i.origin,destination:i.destination}},l=o(d);n.extend(l.position)})),e.fitBounds(n),window.Echo.private(channel).listen(echoEvent,(n=>{let i=r.find((o=>o.driver.id===n.driver.id));i?(i.marker.setPosition({lat:Number(n.coords.latitude),lng:Number(n.coords.longitude)}),i.marker.setAnimation(google.maps.Animation.BOUNCE),setTimeout((()=>{i.marker.setAnimation(null)}),600)):o(n);const t=new google.maps.LatLngBounds;r.forEach((o=>{const e=o.marker;t.extend(e.position)})),e.fitBounds(t)}))})();
