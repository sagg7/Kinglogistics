class simpleTableAG{constructor(t){this.validationFunction=t.validationFunction,this.pinnedBottomFunction=t.pinnedBottomFunction?t.pinnedBottomFunction:()=>{},this.onTotalCalc=t.onTotalCalc,this.onRemoveRow=t.onRemoveRow,this.removeValidation=t.removeValidation,this.id=t.id,this.columns=t.columns,this.columnDefs=[],this.iva_percentage=t.iva_percentage?t.iva_percentage:16,this.constructColumns();let i=this.columnDefs,o=this.rowData=t.rowData?t.rowData:[];this.gridOptions={columnDefs:i,rowData:o,rowDragManaged:!0,animateRows:!0,pagination:!1,stopEditingWhenGridLosesFocus:!0,pinnedBottomRowData:this.pinnedBottomFunction(this),defaultColDef:{flex:1,minWidth:100,sortable:!0,resizable:!0},components:{},onGridReady:function(i){i.api.sizeColumnsToFit();let o,n=!1;function e(){new Date-o<450?setTimeout(e,450):(n=!1,i.api.sizeColumnsToFit())}window.addEventListener("resize",(function(){o=new Date,!1===n&&(n=!0,setTimeout(e,450))})),t.autoHeight&&i.api.setDomLayout("autoHeight")},onCellEditingStopped:t=>{let i=t.data,o=this.rowData.findIndex((t=>t.id===i.id&&t.type===i.type));if(this.validationFunction){let t=this.validationFunction(i);t.validation||(this.rowData[o].quantity=t.value)}this.rowData[o].total=Number(i.quantity)*Number(i.price),this.grid.gridOptions.api.setRowData(this.rowData),this.grid.gridOptions.api.setPinnedBottomRowData(this.pinnedBottomFunction(this))},onRowDragEnd:t=>{let i=Object.values(t.api.rowRenderer.rowCompsByIndex),o=[];i.forEach(((t,i)=>{let n=t.rowNode.data,e=this.rowData.findIndex((t=>t.id===n.id&&t.type===n.type));o.push(this.rowData[e])})),this.rowData=o}},"object"==typeof t.gridOptions&&null!==t.gridOptions&&_.merge(this.gridOptions,t.gridOptions),this.init()}constructColumns(){this.columns.forEach((t=>{this.columnDefs.push(t)}))}init(){let t=document.querySelector(`#${this.id}`);this.grid=new agGrid.Grid(t,this.gridOptions)}}
